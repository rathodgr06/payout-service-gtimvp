const a10_0x1ddb03=a10_0x1867;function a10_0x55dc(){const _0x35054e=['INTERNAL_SERVER_ERROR','../config/token','destroy','updateUserById','bcrypt','11XSWEOg','3HelQSD','UNAUTHORIZED','generate-unique-id','../utils/ApiError','token','1405235cqyKmQ','563003jWSAZE','isArray','Email\x20verification\x20failed','abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789','exports','Please\x20authenticate','VERIFY_EMAIL','generateAuthTokens','getFullYear','crypto','REFRESH','user_id','length','toString','RESET_PASSWORD','1785108hLNcZm','verifyToken','http-status','getUserById','54kSuSDG','6561350MfXJmC','13834kkPIBf','test','replace','floor','randomBytes','4843449ihVXSZ','padStart','keys','Password\x20reset\x20failed','getMonth','1482384wrFjuU','object'];a10_0x55dc=function(){return _0x35054e;};return a10_0x55dc();}(function(_0x314e64,_0x5a0fa5){const _0x5cd6c7=a10_0x1867,_0x4fe3c3=_0x314e64();while(!![]){try{const _0x5cee33=parseInt(_0x5cd6c7(0x18c))/0x1*(-parseInt(_0x5cd6c7(0x17b))/0x2)+parseInt(_0x5cd6c7(0x18d))/0x3*(parseInt(_0x5cd6c7(0x175))/0x4)+-parseInt(_0x5cd6c7(0x165))/0x5+parseInt(_0x5cd6c7(0x179))/0x6*(-parseInt(_0x5cd6c7(0x166))/0x7)+-parseInt(_0x5cd6c7(0x185))/0x8+parseInt(_0x5cd6c7(0x180))/0x9+parseInt(_0x5cd6c7(0x17a))/0xa;if(_0x5cee33===_0x5a0fa5)break;else _0x4fe3c3['push'](_0x4fe3c3['shift']());}catch(_0x3f1f13){_0x4fe3c3['push'](_0x4fe3c3['shift']());}}}(a10_0x55dc,0x5b608));const httpStatus=require(a10_0x1ddb03(0x177)),bcrypt=require(a10_0x1ddb03(0x18b)),tokenService=require('./token.service'),userService=require('./user.service'),db=require('../models'),Token=db[a10_0x1ddb03(0x164)],ApiError=require(a10_0x1ddb03(0x163)),{tokenTypes}=require(a10_0x1ddb03(0x188)),generateUniqueId=require(a10_0x1ddb03(0x162)),crypto=require(a10_0x1ddb03(0x16f)),isNotValid=_0x2ca9d0=>{const _0x23bd1b=a10_0x1ddb03;return _0x2ca9d0===null||_0x2ca9d0===undefined||_0x2ca9d0===''||typeof _0x2ca9d0===_0x23bd1b(0x186)&&!Array[_0x23bd1b(0x167)](_0x2ca9d0)&&Object[_0x23bd1b(0x182)](_0x2ca9d0)[_0x23bd1b(0x172)]===0x0||Array[_0x23bd1b(0x167)](_0x2ca9d0)&&_0x2ca9d0[_0x23bd1b(0x172)]===0x0;},isValid=_0xbe8e3f=>!isNotValid(_0xbe8e3f),isValidEmail=_0x167fb5=>{const _0x15edf9=a10_0x1ddb03,_0x527886=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;return _0x527886[_0x15edf9(0x17c)](_0x167fb5);};function generateKey(){const _0x1c0ada=a10_0x1ddb03;return crypto[_0x1c0ada(0x17f)](0x10)[_0x1c0ada(0x173)]('hex');}const make_unique_id=async()=>{const _0x36d4e9=a10_0x1ddb03;let _0x57b923='';try{_0x57b923=generateUniqueId({'length':0xd,'useLetters':![]});}catch(_0x464e47){new ApiError(httpStatus[_0x36d4e9(0x187)],_0x464e47['message']);}finally{return _0x57b923;}},parseFormattedNumber=_0x4a0812=>{const _0x4f0dd1=a10_0x1ddb03;if(!_0x4a0812)return 0x0;return parseFloat(String(_0x4a0812)[_0x4f0dd1(0x17d)](/,/g,''));},logout=async _0x1b4968=>{const _0xbdf615=a10_0x1ddb03,_0xeed3e0=await Token['findOne']({'where':{'token':_0x1b4968,'type':tokenTypes[_0xbdf615(0x170)],'black_listed':![]}});if(!_0xeed3e0)return null;await _0xeed3e0[_0xbdf615(0x189)]();},refreshAuth=async _0x3e69f=>{const _0x499c5a=a10_0x1ddb03;try{const _0x4a4555=await tokenService[_0x499c5a(0x176)](_0x3e69f,tokenTypes[_0x499c5a(0x170)]),_0x41afdc=await userService[_0x499c5a(0x178)](_0x4a4555[_0x499c5a(0x171)]);if(!_0x41afdc)throw new Error();return await _0x4a4555[_0x499c5a(0x189)](),tokenService[_0x499c5a(0x16d)](_0x41afdc);}catch(_0x134835){throw new ApiError(httpStatus[_0x499c5a(0x18e)],_0x499c5a(0x16b));}},resetPassword=async(_0x4bb9df,_0x2e1114)=>{const _0x8f45d5=a10_0x1ddb03;try{const _0x1fa665=await tokenService[_0x8f45d5(0x176)](_0x4bb9df,tokenTypes[_0x8f45d5(0x174)]),_0x532329=await userService[_0x8f45d5(0x178)](_0x1fa665[_0x8f45d5(0x171)]);if(!_0x532329)throw new Error();await userService['updateUserById'](_0x532329['id'],{'password':_0x2e1114}),await Token[_0x8f45d5(0x189)]({'where':{'user_id':_0x532329['id'],'type':tokenTypes[_0x8f45d5(0x174)]}});}catch(_0x91c249){throw new ApiError(httpStatus['UNAUTHORIZED'],_0x8f45d5(0x183));}},verifyEmail=async _0x1fba23=>{const _0x250b49=a10_0x1ddb03;try{const _0x5b98df=await tokenService['verifyToken'](_0x1fba23,tokenTypes[_0x250b49(0x16c)]),_0x493bca=await userService[_0x250b49(0x178)](_0x5b98df[_0x250b49(0x171)]);if(!_0x493bca)throw new Error();await Token[_0x250b49(0x189)]({'where':{'user_id':_0x493bca['id'],'type':tokenTypes['VERIFY_EMAIL']}}),await userService[_0x250b49(0x18a)](_0x493bca['id'],{'active':0x1});}catch(_0x24aa41){throw new ApiError(httpStatus[_0x250b49(0x18e)],_0x250b49(0x168));}},make_sequential_no=async _0x523b7a=>{const _0x56b9a4=a10_0x1ddb03;try{const _0xd82a01=String(_0x523b7a)[_0x56b9a4(0x181)](0xa,'0');return _0xd82a01;}catch(_0xbc5cbe){throw new ApiError(httpStatus[_0x56b9a4(0x18e)],_0x56b9a4(0x168));}};function randomString(_0x2ea92,_0x56ab67=0x0){const _0x1276f0=a10_0x1ddb03;let _0x52100a=_0x1276f0(0x169);var _0x34876c='';for(var _0x277e11=_0x2ea92;_0x277e11>0x0;--_0x277e11)_0x34876c+=_0x52100a[Math[_0x1276f0(0x17e)](Math['random']()*_0x52100a[_0x1276f0(0x172)])];return _0x56ab67==0x1?_0x34876c['toUpperCase']():_0x34876c;}function a10_0x1867(_0x468b54,_0x4647d1){const _0x55dc58=a10_0x55dc();return a10_0x1867=function(_0x18677e,_0x4aac6e){_0x18677e=_0x18677e-0x162;let _0x88022d=_0x55dc58[_0x18677e];return _0x88022d;},a10_0x1867(_0x468b54,_0x4647d1);}const make_order_number=async _0x3f3d07=>{const _0x2395cb=a10_0x1ddb03;let _0x87000c=new Date(),_0x3b8e04=_0x87000c['getDate'](),_0x2d3a73=_0x87000c[_0x2395cb(0x184)](),_0x1878a5=_0x87000c[_0x2395cb(0x16e)](),_0x5c0007=_0x3f3d07;return _0x5c0007+=randomString(0x2,0x1)+_0x2d3a73+randomString(0x3,0x1)+_0x3b8e04+randomString(0x2,0x1),_0x5c0007;};module[a10_0x1ddb03(0x16a)]={'isValid':isValid,'isNotValid':isNotValid,'make_unique_id':make_unique_id,'logout':logout,'refreshAuth':refreshAuth,'resetPassword':resetPassword,'verifyEmail':verifyEmail,'parseFormattedNumber':parseFormattedNumber,'make_order_number':make_order_number,'isValidEmail':isValidEmail,'generateKey':generateKey};